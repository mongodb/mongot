load("//bazel/java:package.bzl", "java_library")

java_library(
    name = "lucene",
    srcs = [
        "AbstractLuceneSearchManager.java",
        "Comparators.java",
        "DiskUtilizationAwareMergePolicy.java",
        "EmptySearchBatchProducer.java",
        "FacetMergingBatchProducer.java",
        "GenericDrillSidewaysFactory.java",
        "IndexBackingStrategy.java",
        "InitializedLuceneSearchIndex.java",
        "InitializedLuceneVectorIndex.java",
        "InstrumentedConcurrentMergeScheduler.java",
        "LuceneBoundaryFacetMetaBucketProducer.java",
        "LuceneCachingVectorSearchManager.java",
        "LuceneDrillSideways.java",
        "LuceneFacetCollectorMetaBatchProducer.java",
        "LuceneFacetCollectorMetaBatchProducerFactory.java",
        "LuceneFacetCollectorSearchManager.java",
        "LuceneFacetContext.java",
        "LuceneFacetDrillSidewaysMetaBatchProducerFactory.java",
        "LuceneFacetGenericDrillSidewaysSearchManager.java",
        "LuceneFacetOptimizedDrillSidewaysSearchManager.java",
        "LuceneFacetResultUtil.java",
        "LuceneGlobalSettings.java",
        "LuceneHighlighterContext.java",
        "LuceneIndexFactory.java",
        "LuceneIndexMetricValuesSupplier.java",
        "LuceneIndexResourcesInitializer.java",
        "LuceneIndexSearcherReference.java",
        "LuceneIndexSortFactory.java",
        "LuceneIndexWriter.java",
        "LuceneMetaBucketProducer.java",
        "LuceneMetaResultsBuilder.java",
        "LuceneOperatorSearchManager.java",
        "LuceneScoreDetailsManager.java",
        "LuceneSearchBatchProducer.java",
        "LuceneSearchHighlight.java",
        "LuceneSearchHighlights.java",
        "LuceneSearchHighlightsFormatter.java",
        "LuceneSearchIndex.java",
        "LuceneSearchIndexMetricValuesSupplier.java",
        "LuceneSearchIndexReader.java",
        "LuceneSearchManager.java",
        "LuceneSearchManagerFactory.java",
        "LuceneStringFacetMetaBucketProducer.java",
        "LuceneUnifiedHighlighter.java",
        "LuceneVectorIndex.java",
        "LuceneVectorIndexMetricValuesSupplier.java",
        "LuceneVectorIndexReader.java",
        "LuceneVectorSearchManager.java",
        "MergePolicyFactory.java",
        "MeteredLuceneSearchManager.java",
        "MeteredLuceneVectorSearchManager.java",
        "MongotDrillSideways.java",
        "MultiLuceneIndexWriter.java",
        "MultiLuceneSearchIndexReader.java",
        "MultiLuceneVectorIndexReader.java",
        "OptimizedDrillSidewaysFactory.java",
        "PeriodicLuceneIndexRefresher.java",
        "SearchMergingBatchProducer.java",
        "SingleLuceneIndexWriter.java",
        "SortValuesProvider.java",
        "VectorMergePolicy.java",
    ],
    javacopts = ["-Xep:IntLongMath:ERROR"],
    visibility = ["//visibility:public"],
    exports = [
        "//src/main/java/com/xgen/mongot/cursor/batch",
        "//src/main/java/com/xgen/mongot/index",
        "//src/main/java/com/xgen/mongot/index/definition",
        "//src/main/java/com/xgen/mongot/index/lucene/commit",
        "//src/main/java/com/xgen/mongot/index/lucene/explain/explainers",
        "//src/main/java/com/xgen/mongot/index/lucene/field",
        "//src/main/java/com/xgen/mongot/index/lucene/searcher",
        "//src/main/java/com/xgen/mongot/index/path/string",
        "//src/main/java/com/xgen/mongot/index/query/collectors",
        "//src/main/java/com/xgen/mongot/index/query/highlights",
        "//src/main/java/com/xgen/mongot/index/status",
        "//src/main/java/com/xgen/mongot/index/synonym",
        "//src/main/java/com/xgen/mongot/index/version",
        "//src/main/java/com/xgen/mongot/monitor",
        "@maven//:io_micrometer_micrometer_core",
        "@maven//:org_apache_lucene_lucene_core",
        "@maven//:org_apache_lucene_lucene_facet",
        "@maven//:org_mongodb_bson",
        "@maven//:org_slf4j_slf4j_api",
    ],
    deps = [
        "//src/main/java/com/xgen/mongot/cursor/batch",
        "//src/main/java/com/xgen/mongot/featureflag",
        "//src/main/java/com/xgen/mongot/featureflag/dynamic",
        "//src/main/java/com/xgen/mongot/index",
        "//src/main/java/com/xgen/mongot/index/analyzer",
        "//src/main/java/com/xgen/mongot/index/analyzer/custom",
        "//src/main/java/com/xgen/mongot/index/analyzer/definition",
        "//src/main/java/com/xgen/mongot/index/analyzer/wrapper",
        "//src/main/java/com/xgen/mongot/index/definition",
        "//src/main/java/com/xgen/mongot/index/ingestion",
        "//src/main/java/com/xgen/mongot/index/lucene/blobstore",
        "//src/main/java/com/xgen/mongot/index/lucene/codec",
        "//src/main/java/com/xgen/mongot/index/lucene/commit",
        "//src/main/java/com/xgen/mongot/index/lucene/config",
        "//src/main/java/com/xgen/mongot/index/lucene/directory",
        "//src/main/java/com/xgen/mongot/index/lucene/document",
        "//src/main/java/com/xgen/mongot/index/lucene/document/builder",
        "//src/main/java/com/xgen/mongot/index/lucene/explain",
        "//src/main/java/com/xgen/mongot/index/lucene/explain/explainers",
        "//src/main/java/com/xgen/mongot/index/lucene/explain/profiler",
        "//src/main/java/com/xgen/mongot/index/lucene/explain/timing",
        "//src/main/java/com/xgen/mongot/index/lucene/explain/tracing",
        "//src/main/java/com/xgen/mongot/index/lucene/facet",
        "//src/main/java/com/xgen/mongot/index/lucene/field",
        "//src/main/java/com/xgen/mongot/index/lucene/quantization",
        "//src/main/java/com/xgen/mongot/index/lucene/query",
        "//src/main/java/com/xgen/mongot/index/lucene/query/context",
        "//src/main/java/com/xgen/mongot/index/lucene/query/custom",
        "//src/main/java/com/xgen/mongot/index/lucene/query/highlights",
        "//src/main/java/com/xgen/mongot/index/lucene/query/pushdown/project",
        "//src/main/java/com/xgen/mongot/index/lucene/query/sort",
        "//src/main/java/com/xgen/mongot/index/lucene/query/sort/mixed",
        "//src/main/java/com/xgen/mongot/index/lucene/query/util",
        "//src/main/java/com/xgen/mongot/index/lucene/searcher",
        "//src/main/java/com/xgen/mongot/index/lucene/similarity",
        "//src/main/java/com/xgen/mongot/index/lucene/synonym",
        "//src/main/java/com/xgen/mongot/index/lucene/util",
        "//src/main/java/com/xgen/mongot/index/path/string",
        "//src/main/java/com/xgen/mongot/index/query",
        "//src/main/java/com/xgen/mongot/index/query/collectors",
        "//src/main/java/com/xgen/mongot/index/query/counts",
        "//src/main/java/com/xgen/mongot/index/query/highlights",
        "//src/main/java/com/xgen/mongot/index/query/operators",
        "//src/main/java/com/xgen/mongot/index/query/sort",
        "//src/main/java/com/xgen/mongot/index/status",
        "//src/main/java/com/xgen/mongot/index/synonym",
        "//src/main/java/com/xgen/mongot/index/version",
        "//src/main/java/com/xgen/mongot/logging",
        "//src/main/java/com/xgen/mongot/metrics",
        "//src/main/java/com/xgen/mongot/monitor",
        "//src/main/java/com/xgen/mongot/trace",
        "//src/main/java/com/xgen/mongot/util",
        "//src/main/java/com/xgen/mongot/util/bson",
        "//src/main/java/com/xgen/mongot/util/concurrent",
        "//src/main/java/com/xgen/mongot/util/timers",
        "@maven//:com_google_code_findbugs_jsr305",
        "@maven//:com_google_errorprone_error_prone_annotations",
        "@maven//:com_google_flogger_flogger",
        "@maven//:com_google_guava_guava",
        "@maven//:io_micrometer_micrometer_core",
        "@maven//:io_opentelemetry_opentelemetry_context",
        "@maven//:org_apache_lucene_lucene_backward_codecs",  # keep: required to read indices with legacy codecs
        "@maven//:org_apache_lucene_lucene_core",
        "@maven//:org_apache_lucene_lucene_facet",
        "@maven//:org_apache_lucene_lucene_highlighter",
        "@maven//:org_apache_lucene_lucene_sandbox",
        "@maven//:org_mongodb_bson",
        "@maven//:org_mongodb_mongodb_driver_core",
        "@maven//:org_slf4j_slf4j_api",
    ],
)
