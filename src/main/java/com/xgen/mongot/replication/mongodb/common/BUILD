load("//bazel/java:package.bzl", "java_library")

java_library(
    name = "common",
    srcs = [
        "AggregateCommandCollectionScanMongoClient.java",
        "BufferlessIdOrderInitialSyncResumeInfo.java",
        "BufferlessNaturalOrderInitialSyncResumeInfo.java",
        "ChangeStreamAggregateCommandFactory.java",
        "ChangeStreamAggregateOperationBuilder.java",
        "ChangeStreamAggregateOperationFactory.java",
        "ChangeStreamBatch.java",
        "ChangeStreamCursorClientException.java",
        "ChangeStreamDocumentUtils.java",
        "ChangeStreamModeSelector.java",
        "ChangeStreamMongoClient.java",
        "ChangeStreamMongoCursorClient.java",
        "ChangeStreamResumeInfo.java",
        "ChangeStreams.java",
        "ClientSessionRecord.java",
        "CollectionSamplingMongoClient.java",
        "CollectionScanCommandMongoClient.java",
        "CollectionScanMongoClient.java",
        "CollectionStatsMongoClient.java",
        "DecodingSchedulerBatch.java",
        "DecodingWorkScheduler.java",
        "DefaultChangeStreamMongoClient.java",
        "DefaultDocumentIndexer.java",
        "DefaultIndexingWorkScheduler.java",
        "DefaultNamespaceResolver.java",
        "DefaultSessionRefresher.java",
        "DocumentBatchDecoder.java",
        "DocumentIndexer.java",
        "EmbeddingIndexingWorkScheduler.java",
        "FindCommandCollectionScanMongoClient.java",
        "FragmentBuffer.java",
        "FragmentProcessingException.java",
        "HeuristicChangeStreamModeSelector.java",
        "IndexCommitUserData.java",
        "IndexStateInfo.java",
        "IndexingSchedulerBatch.java",
        "IndexingWorkScheduler.java",
        "IndexingWorkSchedulerFactory.java",
        "InitialSyncException.java",
        "InitialSyncResumeInfo.java",
        "MetadataNamespace.java",
        "MongoDbReplicationConfig.java",
        "MongoExceptionUtils.java",
        "MongoViewExceptionUtils.java",
        "NamespaceResolutionException.java",
        "NamespaceResolver.java",
        "NoShardFoundException.java",
        "PauseInitialSyncException.java",
        "PeriodicIndexCommitter.java",
        "Projection.java",
        "RefreshingClientSession.java",
        "ReplicationOptimeUpdater.java",
        "ResumeTokenUtils.java",
        "SchedulerQueue.java",
        "SessionRefresher.java",
        "SplitEventChangeStreamClient.java",
        "StaleStateInfo.java",
        "SteadyStateException.java",
        "SynonymSyncException.java",
        "TimeableChangeStreamMongoClient.java",
        "UnsupportedMongoDbVersionException.java",
        "ViewPipeline.java",
        "WrapIfThrows.java",
    ],
    visibility = ["//visibility:public"],
    exports = [
        "//src/main/java/com/xgen/mongot/index",
        "//src/main/java/com/xgen/mongot/index/definition",
        "//src/main/java/com/xgen/mongot/index/status",
        "//src/main/java/com/xgen/mongot/index/version",
        "//src/main/java/com/xgen/mongot/util/mongodb",
        "@maven//:org_mongodb_bson",
        "@maven//:org_mongodb_mongodb_driver_core",
        "@maven//:org_slf4j_slf4j_api",
    ],
    deps = [
        "//bazel/java:netty-tcnative",  # keep: native netty
        "//src/main/java/com/xgen/mongot/catalog",
        "//src/main/java/com/xgen/mongot/embedding",
        "//src/main/java/com/xgen/mongot/embedding/exceptions",
        "//src/main/java/com/xgen/mongot/embedding/providers",
        "//src/main/java/com/xgen/mongot/embedding/providers/configs",
        "//src/main/java/com/xgen/mongot/embedding/utils",
        "//src/main/java/com/xgen/mongot/index",
        "//src/main/java/com/xgen/mongot/index/definition",
        "//src/main/java/com/xgen/mongot/index/status",
        "//src/main/java/com/xgen/mongot/index/synonym",
        "//src/main/java/com/xgen/mongot/index/version",
        "//src/main/java/com/xgen/mongot/logging",
        "//src/main/java/com/xgen/mongot/metrics",
        "//src/main/java/com/xgen/mongot/util",
        "//src/main/java/com/xgen/mongot/util/bson",
        "//src/main/java/com/xgen/mongot/util/bson/parser",
        "//src/main/java/com/xgen/mongot/util/concurrent",
        "//src/main/java/com/xgen/mongot/util/functionalinterfaces",
        "//src/main/java/com/xgen/mongot/util/mongodb",
        "//src/main/java/com/xgen/mongot/util/mongodb/serialization",
        "@maven//:com_github_luben_zstd_jni",  # keep: required at runtime
        "@maven//:com_google_code_findbugs_jsr305",
        "@maven//:com_google_errorprone_error_prone_annotations",
        "@maven//:com_google_flogger_flogger",
        "@maven//:com_google_guava_guava",
        "@maven//:commons_codec_commons_codec",
        "@maven//:io_micrometer_micrometer_core",
        "@maven//:org_apache_commons_commons_lang3",
        "@maven//:org_jetbrains_annotations",
        "@maven//:org_mongodb_bson",
        "@maven//:org_mongodb_mongodb_driver_core",
        "@maven//:org_mongodb_mongodb_driver_sync",
        "@maven//:org_slf4j_slf4j_api",
        "@maven//:org_xerial_snappy_snappy_java",  # keep: required at runtime
    ],
)
